!function(e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n(require,exports,module):e.Vex=n()}(this,function(e,n,t){"use strict";return function(){var o;o=function(e){var n,t;return n=!1,e(function(){var o;return o=(document.body||document.documentElement).style,n=void 0!==o.animation||void 0!==o.WebkitAnimation||void 0!==o.MozAnimation||void 0!==o.MsAnimation||void 0!==o.OAnimation,e(window).bind("keyup.vex",function(e){return 27===e.keyCode?t.closeByEscape():void 0})}),t={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(n){return n=e.extend({},t.defaultOptions,n),n.id=t.globalID,t.globalID+=1,n.$vex=e("<div>").addClass(t.baseClassNames.vex).addClass(n.className).css(n.css).data({vex:n}),n.$vexOverlay=e("<div>").addClass(t.baseClassNames.overlay).addClass(n.overlayClassName).css(n.overlayCSS).data({vex:n}),n.overlayClosesOnClick&&n.$vexOverlay.bind("click.vex",function(n){return n.target===this?t.close(e(this).data().vex.id):void 0}),n.$vex.append(n.$vexOverlay),n.$vexContent=e("<div>").addClass(t.baseClassNames.content).addClass(n.contentClassName).css(n.contentCSS).append(n.content).data({vex:n}),n.$vex.append(n.$vexContent),n.showCloseButton&&(n.$closeButton=e("<div>").addClass(t.baseClassNames.close).addClass(n.closeClassName).css(n.closeCSS).data({vex:n}).bind("click.vex",function(){return t.close(e(this).data().vex.id)}),n.$vexContent.append(n.$closeButton)),e(n.appendLocation).append(n.$vex),t.setupBodyClassName(n.$vex),n.afterOpen&&n.afterOpen(n.$vexContent,n),setTimeout(function(){return n.$vexContent.trigger("vexOpen",n)},0),n.$vexContent},getSelectorFromBaseClass:function(e){return"."+e.split(" ").join(".")},getAllVexes:function(){return e("."+t.baseClassNames.vex+':not(".'+t.baseClassNames.closing+'") '+t.getSelectorFromBaseClass(t.baseClassNames.content))},getVexByID:function(n){return t.getAllVexes().filter(function(){return e(this).data().vex.id===n})},close:function(e){var n;if(!e){if(n=t.getAllVexes().last(),!n.length)return!1;e=n.data().vex.id}return t.closeByID(e)},closeAll:function(){var n;return n=t.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=n?n.length:void 0)?(e.each(n.reverse(),function(e,n){return t.closeByID(n)}),!0):!1},closeByID:function(o){var a,s,i,l,d;return s=t.getVexByID(o),s.length?(a=s.data().vex.$vex,d=e.extend({},s.data().vex),i=function(){return d.beforeClose?d.beforeClose(s,d):void 0},l=function(){return s.trigger("vexClose",d),a.remove(),e("body").trigger("vexAfterClose",d),d.afterClose?d.afterClose(s,d):void 0},n?i()!==!1&&a.unbind(t.animationEndEvent).bind(t.animationEndEvent,function(){return l()}).addClass(t.baseClassNames.closing):i()!==!1&&l(),!0):void 0},closeByEscape:function(){var n,o,a;return a=t.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=a?a.length:void 0)?(o=Math.max.apply(Math,a),n=t.getVexByID(o),n.data().vex.escapeButtonCloses!==!0?!1:t.closeByID(o)):!1},setupBodyClassName:function(n){return e("body").bind("vexOpen.vex",function(){return e("body").addClass(t.baseClassNames.open)}).bind("vexAfterClose.vex",function(){return t.getAllVexes().length?void 0:e("body").removeClass(t.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return t.hideLoading(),e("body").append('<div class="vex-loading-spinner '+t.defaultOptions.className+'"></div>')}}},"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof n?t.exports=o(e("jquery")):window.vex=o(jQuery)}.call(void 0),Vex});