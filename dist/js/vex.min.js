!function(e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n(require,exports,module):e.Vex=n()}(this,function(e,n,t){"use strict";function o(e){var n=this,t=!1;e(function(){var n=void 0;return n=(document.body||document.documentElement).style,t=void 0!==n.animation||void 0!==n.WebkitAnimation||void 0!==n.MozAnimation||void 0!==n.MsAnimation||void 0!==n.OAnimation,e(window).bind("keyup.vex",function(e){return 27===e.keyCode?o.closeByEscape():void 0})});var o={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(t){return t=e.extend({},o.defaultOptions,t),t.id=o.globalID,o.globalID+=1,t.$vex=e("<div>").addClass(o.baseClassNames.vex).addClass(t.className).css(t.css).data({vex:t}),t.$vexOverlay=e("<div>").addClass(o.baseClassNames.overlay).addClass(t.overlayClassName).css(t.overlayCSS).data({vex:t}),t.overlayClosesOnClick&&t.$vexOverlay.bind("click.vex",function(t){return t.target===n?o.close(e(n).data().vex.id):void 0}),t.$vex.append(t.$vexOverlay),t.$vexContent=e("<div>").addClass(o.baseClassNames.content).addClass(t.contentClassName).css(t.contentCSS).append(t.content).data({vex:t}),t.$vex.append(t.$vexContent),t.showCloseButton&&(t.$closeButton=e("<div>").addClass(o.baseClassNames.close).addClass(t.closeClassName).css(t.closeCSS).data({vex:t}).bind("click.vex",function(){return o.close(e(n).data().vex.id)}),t.$vexContent.append(t.$closeButton)),e(t.appendLocation).append(t.$vex),o.setupBodyClassName(t.$vex),t.afterOpen&&t.afterOpen(t.$vexContent,t),setTimeout(function(){return t.$vexContent.trigger("vexOpen",t)},0),t.$vexContent},getSelectorFromBaseClass:function(e){return"."+e.split(" ").join(".")},getAllVexes:function(){return e("."+o.baseClassNames.vex+':not(".'+o.baseClassNames.closing+'") '+o.getSelectorFromBaseClass(o.baseClassNames.content))},getVexByID:function(n){return o.getAllVexes().filter(function(){return e(this).data().vex.id===n})},close:function(e){var n=void 0;if(!e){if(n=o.getAllVexes().last(),!n.length)return!1;e=n.data().vex.id}return o.closeByID(e)},closeAll:function(){var n=void 0;return n=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=n?n.length:void 0)?(e.each(n.reverse(),function(e,n){return o.closeByID(n)}),!0):!1},closeByID:function(n){var a=o.getVexByID(n);if(a.length){var s=a.data().vex.$vex,i=e.extend({},a.data().vex),l=function(){return i.beforeClose?i.beforeClose(a,i):void 0},d=function(){return a.trigger("vexClose",i),s.remove(),e("body").trigger("vexAfterClose",i),i.afterClose?i.afterClose(a,i):void 0};return t?l()!==!1&&s.unbind(o.animationEndEvent).bind(o.animationEndEvent,function(){return d()}).addClass(o.baseClassNames.closing):l()!==!1&&d(),!0}},closeByEscape:function(){var t=o.getAllVexes().map(function(){return e(n).data().vex.id}).toArray();if(!(null!=t?t.length:void 0))return!1;var a=Math.max.apply(Math,t),s=o.getVexByID(a);return s.data().vex.escapeButtonCloses!==!0?!1:o.closeByID(a)},setupBodyClassName:function(n){return e("body").bind("vexOpen.vex",function(){return e("body").addClass(o.baseClassNames.open)}).bind("vexAfterClose.vex",function(){return o.getAllVexes().length?void 0:e("body").removeClass(o.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return o.hideLoading(),e("body").append('<div class="vex-loading-spinner '+o.defaultOptions.className+'"></div>')}};return o}return"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof n?t.exports=o(e("jquery")):window.vex=o(jQuery),Vex});