!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.Vex=t()}(this,function(e,t,n){"use strict";function o(e){var t=this,n=!1;e(function(){var t=void 0;return t=(document.body||document.documentElement).style,n=void 0!==t.animation||void 0!==t.WebkitAnimation||void 0!==t.MozAnimation||void 0!==t.MsAnimation||void 0!==t.OAnimation,e(window).bind("keyup.vex",function(e){return 27===e.keyCode?o.closeByEscape():void 0})});var o={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(n){return n=e.extend({},o.defaultOptions,n),n.id=o.globalID,o.globalID+=1,n.$vex=e("<div>").addClass(o.baseClassNames.vex).addClass(n.className).css(n.css).data({vex:n}),n.$vexOverlay=e("<div>").addClass(o.baseClassNames.overlay).addClass(n.overlayClassName).css(n.overlayCSS).data({vex:n}),n.overlayClosesOnClick&&n.$vexOverlay.bind("click.vex",function(n){return n.target===t?o.close(e(t).data().vex.id):void 0}),n.$vex.append(n.$vexOverlay),n.$vexContent=e("<div>").addClass(o.baseClassNames.content).addClass(n.contentClassName).css(n.contentCSS).append(n.content).data({vex:n}),n.$vex.append(n.$vexContent),n.showCloseButton&&(n.$closeButton=e("<div>").addClass(o.baseClassNames.close).addClass(n.closeClassName).css(n.closeCSS).data({vex:n}).bind("click.vex",function(){return o.close(e(t).data().vex.id)}),n.$vexContent.append(n.$closeButton)),e(n.appendLocation).append(n.$vex),o.setupBodyClassName(n.$vex),n.afterOpen&&n.afterOpen(n.$vexContent,n),setTimeout(function(){return n.$vexContent.trigger("vexOpen",n)},0),n.$vexContent},getSelectorFromBaseClass:function(e){return"."+e.split(" ").join(".")},getAllVexes:function(){return e("."+o.baseClassNames.vex+':not(".'+o.baseClassNames.closing+'") '+o.getSelectorFromBaseClass(o.baseClassNames.content))},getVexByID:function(t){return o.getAllVexes().filter(function(){return e(this).data().vex.id===t})},close:function(e){var t=void 0;if(!e){if(t=o.getAllVexes().last(),!t.length)return!1;e=t.data().vex.id}return o.closeByID(e)},closeAll:function(){var t=void 0;return t=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=t?t.length:void 0)?(e.each(t.reverse(),function(e,t){return o.closeByID(t)}),!0):!1},closeByID:function(t){var a=o.getVexByID(t);if(a.length){var s=a.data().vex.$vex,i=e.extend({},a.data().vex),r=function(){return i.beforeClose?i.beforeClose(a,i):void 0},l=function(){return a.trigger("vexClose",i),s.remove(),e("body").trigger("vexAfterClose",i),i.afterClose?i.afterClose(a,i):void 0};return n?r()!==!1&&s.unbind(o.animationEndEvent).bind(o.animationEndEvent,function(){return l()}).addClass(o.baseClassNames.closing):r()!==!1&&l(),!0}},closeByEscape:function(){var n=o.getAllVexes().map(function(){return e(t).data().vex.id}).toArray();if(!(null!=n?n.length:void 0))return!1;var a=Math.max.apply(Math,n),s=o.getVexByID(a);return s.data().vex.escapeButtonCloses!==!0?!1:o.closeByID(a)},setupBodyClassName:function(t){return e("body").bind("vexOpen.vex",function(){return e("body").addClass(o.baseClassNames.open)}).bind("vexAfterClose.vex",function(){return o.getAllVexes().length?void 0:e("body").removeClass(o.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return o.hideLoading(),e("body").append('<div class="vex-loading-spinner '+o.defaultOptions.className+'"></div>')}};return o}function a(e,t){var n=this;if("undefined"==typeof t)throw new Error("You must include Vex to use vex.dialog");$formToObject=function(t){var o={};return e.each(t.serializeArray(),function(){return o[n.name]?(o[n.name]=o[n.name].push?o[n.name]:[o[n.name]],o[n.name].push(n.value||"")):o[n.name]=n.value||""}),o};var o={};return o.buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e,n){return e.data().vex.value=!1,t.close(e.data().vex.id)}}},o.defaultOptions={callback:function(e){},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[o.buttons.YES,o.buttons.NO],showCloseButton:!1,onSubmit:function(a){var s=e(n),i=s.parent();return a.preventDefault(),a.stopPropagation(),i.data().vex.value=o.getFormValueOnSubmit($formToObject(s)),t.close(i.data().vex.id)},focusFirstInput:!0},o.defaultAlertOptions={message:"Alert",buttons:[o.buttons.YES]},o.defaultConfirmOptions={message:"Confirm"},o.open=function(n){var a,s;return n=e.extend({},t.defaultOptions,o.defaultOptions,n),n.content=o.buildDialogForm(n),s=n.beforeClose,n.beforeClose=function(e,t){return n.callback(t.value),"function"==typeof s?s(e,t):void 0},a=t.open(n),n.focusFirstInput&&a.find('button[type="submit"], button[type="button"], input[type="submit"], input[type="button"], textarea, input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="email"], input[type="month"], input[type="number"], input[type="password"], input[type="search"], input[type="tel"], input[type="text"], input[type="time"], input[type="url"], input[type="week"]').first().focus(),a},o.alert=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend({},o.defaultAlertOptions,t),o.open(t)},o.confirm=function(t){return"string"==typeof t?e.error("dialog.confirm(options) requires options.callback."):(t=e.extend({},o.defaultConfirmOptions,t),o.open(t))},o.prompt=function(t){var n;return"string"==typeof t?e.error("dialog.prompt(options) requires options.callback."):(n={message:'<label for="vex">'+(t.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(t.placeholder||"")+'"  value="'+(t.value||"")+'" />'},t=e.extend({},n,t),o.open(t))},o.buildDialogForm=function(t){var n,a,s;return n=e('<form class="vex-dialog-form" />'),s=e('<div class="vex-dialog-message" />'),a=e('<div class="vex-dialog-input" />'),n.append(s.append(t.message)).append(a.append(t.input)).append(o.buttonsToDOM(t.buttons)).bind("submit.vex",t.onSubmit),n},o.getFormValueOnSubmit=function(e){return formData.vex||""===formData.vex?"_vex-empty-value"===formData.vex?!0:formData.vex:formData},o.buttonsToDOM=function(o){var a;return a=e('<div class="vex-dialog-buttons" />'),e.each(o,function(s,i){var r;return r=e('<button type="'+i.type+'"></button>').text(i.text).addClass(i.className+" vex-dialog-button "+(0===s?"vex-first ":"")+(s===o.length-1?"vex-last ":"")).bind("click.vex",function(o){return i.click?i.click(e(n).parents(t.getSelectorFromBaseClass(t.baseClassNames.content)),o):void 0}),r.appendTo(a)}),a},o}return"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof t?n.exports=o(e("jquery")):window.vex=o(jQuery),"function"==typeof define&&define.amd?define(["jquery","vex"],a):"object"==typeof t?n.exports=a(e("jquery"),e("./vex.js")):window.vex.dialog=a(window.jQuery,window.vex),Vex});