!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.vex=t()}(this,function(e,t,n){"use strict";var a=!1;$(function(){var e=(document.body||document.documentElement).style;return a=void 0!==e.animation||void 0!==e.WebkitAnimation||void 0!==e.MozAnimation||void 0!==e.MsAnimation||void 0!==e.OAnimation,$(window).bind("keyup.vex",function(e){return 27===e.keyCode?o.closeByEscape():void 0})});var o={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(e){return e=$.extend({},o.defaultOptions,e),e.id=o.globalID,o.globalID+=1,e.$vex=$("<div>").addClass(o.baseClassNames.vex).addClass(e.className).css(e.css).data({vex:e}),e.$vexOverlay=$("<div>").addClass(o.baseClassNames.overlay).addClass(e.overlayClassName).css(e.overlayCSS).data({vex:e}),e.overlayClosesOnClick&&e.$vexOverlay.bind("click.vex",function(e){return e.target===this?o.close($(this).data().vex.id):void 0}),e.$vex.append(e.$vexOverlay),e.$vexContent=$("<div>").addClass(o.baseClassNames.content).addClass(e.contentClassName).css(e.contentCSS).append(e.content).data({vex:e}),e.$vex.append(e.$vexContent),e.showCloseButton&&(e.$closeButton=$("<div>").addClass(o.baseClassNames.close).addClass(e.closeClassName).css(e.closeCSS).data({vex:e}).bind("click.vex",function(){return o.close($(this).data().vex.id)}),e.$vexContent.append(e.$closeButton)),$(e.appendLocation).append(e.$vex),o.setupBodyClassName(e.$vex),e.afterOpen&&e.afterOpen(e.$vexContent,e),setTimeout(function(){return e.$vexContent.trigger("vexOpen",e)},0),e.$vexContent},getSelectorFromBaseClass:function(e){return"."+e.split(" ").join(".")},getAllVexes:function(){return $("."+o.baseClassNames.vex+':not(".'+o.baseClassNames.closing+'") '+o.getSelectorFromBaseClass(o.baseClassNames.content))},getVexByID:function(e){return o.getAllVexes().filter(function(){return $(this).data().vex.id===e})},close:function(e){if(!e){var t=o.getAllVexes().last();if(!t.length)return!1;e=t.data().vex.id}return o.closeByID(e)},closeAll:function(){var e=o.getAllVexes().map(function(){return $(this).data().vex.id}).toArray();return(null!=e?e.length:void 0)?($.each(e.reverse(),function(e,t){return o.closeByID(t)}),!0):!1},closeByID:function(e){var t=o.getVexByID(e);if(t.length){var n=t.data().vex.$vex,s=$.extend({},t.data().vex),i=function(){return s.beforeClose?s.beforeClose(t,s):void 0},l=function(){return t.trigger("vexClose",s),n.remove(),$("body").trigger("vexAfterClose",s),s.afterClose?s.afterClose(t,s):void 0};return a?i()!==!1&&n.unbind(o.animationEndEvent).bind(o.animationEndEvent,function(){return l()}).addClass(o.baseClassNames.closing):i()!==!1&&l(),!0}},closeByEscape:function(){var e=o.getAllVexes().map(function(){return $(this).data().vex.id}).toArray();if(!(null!=e?e.length:void 0))return!1;var t=Math.max.apply(Math,e),n=o.getVexByID(t);return n.data().vex.escapeButtonCloses!==!0?!1:o.closeByID(t)},setupBodyClassName:function(e){return $("body").bind("vexOpen.vex",function(){return $("body").addClass(o.baseClassNames.open)}).bind("vexAfterClose.vex",function(){return o.getAllVexes().length?void 0:$("body").removeClass(o.baseClassNames.open)})},hideLoading:function(){return $(".vex-loading-spinner").remove()},showLoading:function(){return o.hideLoading(),$("body").append('<div class="vex-loading-spinner '+o.defaultOptions.className+'"></div>')}};if("undefined"==typeof o)throw new Error("You must include vex to use vex.dialog");var s=function(e){var t={};return $.each(e.serializeArray(),function(){return t[this.name]?(t[this.name]=t[this.name].push?t[this.name]:[t[this.name]],t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},i={};return i.buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e,t){return e.data().vex.value=!1,o.close(e.data().vex.id)}}},i.defaultOptions={callback:function(e){},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[i.buttons.YES,i.buttons.NO],showCloseButton:!1,onSubmit:function(e){var t=$(this),n=t.parent();return e.preventDefault(),e.stopPropagation(),n.data().vex.value=i.getFormValueOnSubmit(s(t)),o.close(n.data().vex.id)},focusFirstInput:!0},i.defaultAlertOptions={message:"Alert",buttons:[i.buttons.YES]},i.defaultConfirmOptions={message:"Confirm"},i.open=function(e){e=$.extend({},o.defaultOptions,i.defaultOptions,e),e.content=i.buildDialogForm(e);var t=e.beforeClose;e.beforeClose=function(n,a){return e.callback(a.value),"function"==typeof t?t(n,a):void 0};var n=o.open(e);return e.focusFirstInput&&n.find('button[type="submit"], button[type="button"], input[type="submit"], input[type="button"], textarea, input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="email"], input[type="month"], input[type="number"], input[type="password"], input[type="search"], input[type="tel"], input[type="text"], input[type="time"], input[type="url"], input[type="week"]').first().focus(),n},i.alert=function(e){return"string"==typeof e&&(e={message:e}),e=$.extend({},i.defaultAlertOptions,e),i.open(e)},i.confirm=function(e){return"string"==typeof e?$.error("dialog.confirm(options) requires options.callback."):(e=$.extend({},i.defaultConfirmOptions,e),i.open(e))},i.prompt=function(e){if("string"==typeof e)return $.error("dialog.prompt(options) requires options.callback.");var t={message:'<label for="vex">'+(e.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(e.placeholder||"")+'"  value="'+(e.value||"")+'" />'};return e=$.extend({},t,e),i.open(e)},i.buildDialogForm=function(e){var t=$('<form class="vex-dialog-form" />'),n=$('<div class="vex-dialog-message" />'),a=$('<div class="vex-dialog-input" />');return t.append(n.append(e.message)).append(a.append(e.input)).append(i.buttonsToDOM(e.buttons)).bind("submit.vex",e.onSubmit),t},i.getFormValueOnSubmit=function(e){return e.vex||""===e.vex?"_vex-empty-value"===e.vex?!0:e.vex:e},i.buttonsToDOM=function(e){var t=$('<div class="vex-dialog-buttons" />');return $.each(e,function(n,a){var s=$('<button type="'+a.type+'"></button>').text(a.text).addClass(a.className+" vex-dialog-button "+(0===n?"vex-first ":"")+(n===e.length-1?"vex-last ":"")).bind("click.vex",function(e){return a.click?a.click($(this).parents(o.getSelectorFromBaseClass(o.baseClassNames.content)),e):void 0});return s.appendTo(t)}),t},o.dialog=i,o});